
## Comunicação entre Processos

- Até agora trabalhámos em ambientes multitarefa em que este dá-nos uma vantagem de basear-se em memória partilhada que permite que o estado seja partilhado entre tarefas.
- Com isto vamos partir para algo mais genérico de processos a cooperarem entre si.

> [!NOTE] O que muda do ambiente multitarefa?
> Aqui temos espaços de endereçamento mais disjuntos e isolados uns dos outros.

- Aqui os processos podem comunicar na mesma máquina ou através de redes.

> [!TIP] A comunicação entre processos pode realizar-se em três âmbitos:
> 
> - Uma ==única aplicação==: um processo que executa a interface cliente comunica com o servidor que gere a base de dados.
> - Entre ==aplicações da mesma máquina==: uma aplicação comunica com o servidor de impressão (_spooler_).
> - Enter ==máquinas ligadas por uma rede de dados==: um telemóvel interacta com servidores de um motor de pesquisa.
> 
> 

### Troca de informação entre dois processos

- Muito parecido com produtores-consumidores.

![[Pasted image 20230102161759.png]]

- Temos aqui um produtor (dá informação) e um consumidor que pretendem enviar uma mensagem.
- Sempre que um proocesso pretende enviar uma mensagem precisa de um canal de comuniação.
- O canal pode ter diferentes implementações.

### Canal de Comunicação

- ==Ficheiros== - solução mais simples mas __lenta__. Usada em sistemas de informação.

- ==Memória Partilhada== - precisa de mecanismos para mapear uma região da memória física em dois processos ultrapassando o isolamento de espaços de endereçamento.

- ==Sistema Operativo== - precisa de um objeto para onde copiar a informação da mensgem e permita aos processos consumidor receberem-no.

- ==Redes==

### Arquitetura da Comunicação: Memória Partilhada

- Temos dois espaços de endereçamento disjuntos e temos que criar uma zona de memória partilhada entre esses dois espaços.
- Esse espaço só acontece pedindo ao SO para arranjar essa memória partilhada.

Ler Informação => Receber 
Escrever Informação => Enviar


> [!TIP] Portanto:
> Em multitarefa só declarávamos as variáveis no ambiente e usávamos onde queriamos e aqui temos que declarar nesses espaços específicos.


### Canal: Núcleo do SO

- Temos um produtor e um consumidor com espaços de endereçamento separados e o produtor produziu uma mensagem que quero passar para o outro.
- ___Não se pode passar diretamente___ e ___Não há memória partilhada___, portanto tem que ser feita uma cópia para um núcleo e o outro quando quiser ler pede ao núcleo e será transferida essa informação para o seu espaço de endereçamento.


## Comparação entre os dois usos:

| Memória Partilhada                                     | Objetos do núcleo                                                                                                                |
| ------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------- |
| Executa-se em modo utilizador. + rápido.               | Executa-se no núcleo que tem sobrecarga de chamadas. + lento.                                                                    |
| A informação é acedida. Não há acessos extra à memória | A informação é copiada para o núcleo e volta a ser copiada para o espaço do consumidor. Sobrecarga de duas cópias de informação. |
| As funções de enviar e receber são programadas e podem ocorrer erros. Programação + complexa.  | Funções do SO. Programação + fácil. |

## Modelos de Comunicação

> [!NOTE]  Contudo não nos podemos limitar a uma mensagem então quando se quer transmitir + doque 1 mensagem  usamos modelos de comunicação.
> 
> - Um para um.
> - Um para vários.
> - Muitos para um.
> - Um para muitos.

==Muitos-para-um==: O _cliente_ sabe o endereço do _servidor_ e envia-lhe a mensagem. Deve enviar o remetente para obter resposta do servidor.
Não existe ligação entre processos. (___Processo Correio___)

==Um-para-um de muitos==: O _cliente_ pede para ligar-se ao _servidor_ e este decide se bloqueia ou não a ligação.
Quando se ligam criam um canal um-para-um dedicado.
No final desligam o canal.
Estabelece-se uma ligação de processos. (___Telefone___)


## Correio (Canal sem ligação)

- Este canal de comunicação é chamado de _mailbox_ ou _queue_.
- Esta _mailbox_ consegue ___memorizar___ as mensagens quando são mais rapidamente produzidas do que consumidas.
- É aqui que entra os _pipes_.


